"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("fast-deep-equal")),r=require("next-redux-wrapper"),o=require("lz-string"),n=require("nookies"),i=require("immer"),a=e(require("lodash/get")),c=e(require("lodash/set"));function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e}).apply(this,arguments)}function s(e,t){if(null==e)return{};var r,o,n={},i=Object.keys(e);for(o=0;o<i.length;o++)t.indexOf(r=i[o])>=0||(n[r]=e[r]);return n}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function p(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return f(e,void 0);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(e,void 0):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0;return function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var d=function(){return"undefined"!=typeof window},l=function(){function e(e){this._config=new Map,this._context=e}e._encodeState=function(e){return encodeURIComponent(JSON.stringify(e))},e._encodeStateCompressed=function(e){return o.compressToEncodedURIComponent(JSON.stringify(e))},e._decodeState=function(e,t){return JSON.parse((t?o.decompressFromEncodedURIComponent:decodeURIComponent)(e))};var t=e.prototype;return t.setConfigurations=function(e){for(var t,r=p(e);!(t=r()).done;){var o=t.value;this._config.set(o.cookieName,o)}},t.getAll=function(){if(void 0===this._cookies||d()){this._cookies={};for(var t=0,r=Object.entries(n.parseCookies(this._context,{decode:function(e){return e}}));t<r.length;t++){var o=r[t],i=o[0],a=o[1],c=this._config.get(i);c&&(this._cookies[i]=e._decodeState(a,c.compress))}}return this._cookies},t.set=function(t,r){var o=this._config.get(t);n.setCookie(this._context,t,r,u({},o.cookieOptions,{encode:o.compress?e._encodeStateCompressed:e._encodeState,httpOnly:!1}))},e}(),m=function(e,t,r,o){return i.produce(r,(function(n){for(var i,u=p(e);!(i=u()).done;){var s=i.value,f=s.subtree,d=t(s,a(r,f),a(o,f));void 0!==d&&c(n,f,d)}}))},v="next-redux-cookie-wrapper/SERVE_COOKIES";exports.SERVE_COOKIES=v,exports.nextReduxCookieMiddleware=function(e){return function(o){var n,i=function(e){var t=u({ignoreStateFromStaticProps:!0,compress:!0,path:"/",sameSite:!0},e),r=t.subtrees,o=s(t,["subtrees"]);return r.map((function(e){"string"==typeof e&&(e={subtree:e});var t=u({},o,{cookieName:e.subtree},e);return{ignoreStateFromStaticProps:t.ignoreStateFromStaticProps,compress:t.compress,subtree:t.subtree,cookieName:t.cookieName,cookieOptions:s(t,["ignoreStateFromStaticProps","compress","subtree","cookieName"])}}))}(e);return d()&&(n=new l).setConfigurations(i),function(e){return function(a){switch(a.type){case v:(n=a.payload).setConfigurations(i);var c=n.getAll();return void o.dispatch({type:r.HYDRATE,payload:m(i,(function(e){return c[e.cookieName]}),{})});case r.HYDRATE:if(d()){var u=n.getAll();a.payload=m(i,(function(e){if(e.ignoreStateFromStaticProps)return u[e.cookieName]}),a.payload)}default:var s=o.getState(),f=e(a),p=o.getState();return n&&m(i,(function(e,r,o){var i=e.cookieName;t(r,o)||n.set(i,o)}),s,p),f}}}}},exports.wrapMakeStore=function(e){return function(t){var o=e(t);return d()?o.dispatch({type:r.HYDRATE,payload:{}}):(function(e){return void 0!==e.ctx}(t)&&(t=t.ctx),function(e){return void 0!==e.req&&void 0!==e.res}(t)&&o.dispatch({type:v,payload:new l(t)})),o}};
//# sourceMappingURL=next-redux-cookie-wrapper.cjs.production.min.js.map
